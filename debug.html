<!DOCTYPE HTML>
<html lang="en-US">
  <head>
    <title>ELC IFrame Debugger</title>
  </head>
  <body>
    <div>
      <textarea rows="100" cols="20" id="input" placeholder="Paste postmessage here" style="resize: none;width: 400px; height: 120px;color:black;"></textarea>
    </div>
    <div>
      <span style="color: #999999;">Example postmessage:</span>
      <pre><code>{"_elc_action":"product.getProducts","productIds":["PROD93195"]}</code>
      </pre>
    </div>
    <button class="button1" id="send">Send postmessage</button>

    <!-- The Iframe response will be displayed here -->
    <div id="response"></div>

    <script>
      // Required script
      var iframeResizerContentWindow = document.createElement('script');
      iframeResizerContentWindow.src = 'https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.1/iframeResizer.contentWindow.min.js';
      iframeResizerContentWindow.type = 'text/javascript';

      // Recommended settings to avoid scrolling issues on multi-step experiences
      window.iFrameResizer = {
          autoResize: false,
          sizeHeight: true,
      };

      // Optionally start capturing clicks before contentWindow script has loaded
      document.getElementById('send').addEventListener('click', function() {
        document.getElementById('response').innerHTML = '';
        let x = document.getElementById('input').value;
        let postMessage = JSON.parse(x);
        console.log(postMessage);
        if ('parentIFrame' in window) {
          window.parentIFrame.sendMessage(postMessage);
        } else {
          // Your custom code to display loading state...
        }
      });

      // Experience starts after the window.parentIFrame is available, which is determined by parent IFrame.
      // Listen to incoming messages from the Parent IFrame
      window.addEventListener('message', (event) => {
        let z = event.data;
        if (z.includes('_elc_action')) {
          document.getElementById('response').innerHTML = z;
          console.log(z);
        }
      }, false);

      // Start loading the required content window script
      document.getElementsByTagName('head')[0].appendChild(iframeResizerContentWindow);

      </script>
  </body>
</html>